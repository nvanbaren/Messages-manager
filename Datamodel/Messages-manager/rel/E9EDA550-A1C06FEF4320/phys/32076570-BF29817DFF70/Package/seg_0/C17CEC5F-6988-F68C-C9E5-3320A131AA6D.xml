<?xml version = '1.0' encoding = 'UTF-8'?>
<PackageOracle class="oracle.dbtools.crest.model.design.storage.oracle.PackageOracle" name="DO_TRANSLATIONS" directorySegmentName="seg_0" id="C17CEC5F-6988-F68C-C9E5-3320A131AA6D">
<sourceConnName>Message translations</sourceConnName>
<sourceObjSchema>MESSAGE_OWNER</sourceObjSchema>
<sourceObjName>DO_TRANSLATIONS</sourceObjName>
<createdBy>nicolette</createdBy>
<createdTime>2015-07-12 17:07:15 UTC</createdTime>
<ownerDesignName>Messages-manager</ownerDesignName>
<owner>C9836D5C-BFA7-DD60-9FE3-BFA211ED4B79</owner>
<source>CREATE OR REPLACE package MESSAGE_OWNER.DO_TRANSLATIONS &lt;br/&gt;as&lt;br/&gt;  &lt;br/&gt;  procedure add_messages (p_application_id    in number&lt;br/&gt;                         ,p_language          in varchar2&lt;br/&gt;                         ,p_workspace         in varchar2&lt;br/&gt;                         ,p_include_custom    in varchar2 default &apos;Y&apos;&lt;br/&gt;                         ,p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;                         );&lt;br/&gt;                         &lt;br/&gt;  procedure add_shortcuts(p_application_id in number&lt;br/&gt;                         ,p_workspace      in varchar2&lt;br/&gt;                         );&lt;br/&gt;                         &lt;br/&gt;  function add_messages (p_application_id    in number&lt;br/&gt;                        ,p_language          in varchar2&lt;br/&gt;                        ,p_include_custom    in varchar2 default &apos;Y&apos;&lt;br/&gt;                        ,p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;                        )&lt;br/&gt;  return varchar2;&lt;br/&gt;&lt;br/&gt;  function add_shortcuts(p_application_id in number)&lt;br/&gt;  return varchar2;&lt;br/&gt;  &lt;br/&gt;  function update_messages (&lt;br/&gt;    p_application_id    in number,&lt;br/&gt;    p_language          in varchar2,&lt;br/&gt;    p_include_custom    in varchar2 default &apos;Y&apos;,&lt;br/&gt;    p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;  )&lt;br/&gt;  return varchar2;&lt;br/&gt;  &lt;br/&gt;  function update_shortcuts(p_application_id in number)&lt;br/&gt;  return varchar2;&lt;br/&gt;  &lt;br/&gt;end do_translations;</source>
<body class="oracle.dbtools.crest.model.design.storage.oracle.PackageBodyOracle" name="DO_TRANSLATIONS" id="C17CEC5F-6988-F68C-C9E5-3320A131AA6D">
<sourceConnName>Message translations</sourceConnName>
<sourceObjSchema>MESSAGE_OWNER</sourceObjSchema>
<sourceObjName>DO_TRANSLATIONS</sourceObjName>
<createdBy>nicolette</createdBy>
<createdTime>2015-07-12 17:07:15 UTC</createdTime>
<ownerDesignName>Messages-manager</ownerDesignName>
<owner>C9836D5C-BFA7-DD60-9FE3-BFA211ED4B79</owner>
<source>CREATE OR REPLACE PACKAGE BODY MESSAGE_OWNER.DO_TRANSLATIONS AS&lt;br/&gt;&lt;br/&gt;  c_dll varchar2(100) := &apos;alter session set current_schema=&quot;APEX_040200&quot;&apos;;&lt;br/&gt;&lt;br/&gt;  procedure add_messages (p_application_id    in number&lt;br/&gt;                         ,p_language          in varchar2&lt;br/&gt;                         ,p_workspace         in varchar2&lt;br/&gt;                         ,p_include_custom    in varchar2 default &apos;Y&apos;&lt;br/&gt;                         ,p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;                         )&lt;br/&gt;  is&lt;br/&gt;  &lt;br/&gt;    cursor c_met(b_language varchar2&lt;br/&gt;                ,b_application_id number&lt;br/&gt;                )&lt;br/&gt;    is&lt;br/&gt;      select mes.name&lt;br/&gt;      ,      mes.text&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  mes.language_code = b_language&lt;br/&gt;      and not exists (select &apos;&apos;&lt;br/&gt;                      from   wwv_flow_messages$ mes1&lt;br/&gt;                      where  mes1.flow_id = b_application_id&lt;br/&gt;                      and    mes1.name = mes.name&lt;br/&gt;                     )&lt;br/&gt;    ;&lt;br/&gt;  begin&lt;br/&gt;    execute immediate c_dll;&lt;br/&gt;    wwv_flow_api.set_security_group_id(apex_util.find_security_group_id(p_workspace));&lt;br/&gt;    &lt;br/&gt;    for r_met in c_met(p_language,p_application_id)&lt;br/&gt;    loop&lt;br/&gt;      wwv_flow_api.create_message (&lt;br/&gt;        p_flow_id =&gt; p_application_id,&lt;br/&gt;        p_name =&gt; r_met.name,&lt;br/&gt;        p_message_language =&gt; p_language,&lt;br/&gt;        p_message_text =&gt; r_met.text&lt;br/&gt;      );&lt;br/&gt;    end loop;&lt;br/&gt;    commit;&lt;br/&gt;  end add_messages;&lt;br/&gt;  &lt;br/&gt;  procedure add_shortcuts(p_application_id in number&lt;br/&gt;                         ,p_workspace      in varchar2&lt;br/&gt;                         )&lt;br/&gt;  is&lt;br/&gt;    cursor c_mes(b_application_id in number)&lt;br/&gt;    is&lt;br/&gt;      select mes.name&lt;br/&gt;      ,      decode(mes.javascript,&apos;Y&apos;,&apos;MESSAGE_ESCAPE_JS&apos;,&apos;MESSAGE&apos;) shortcut_type&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  mes.shortcut = &apos;Y&apos;&lt;br/&gt;      and    not exists (select &apos;&apos;&lt;br/&gt;                         from   wwv_flow_shortcuts sho&lt;br/&gt;                         where  sho.shortcut_name = mes.name&lt;br/&gt;                         and    sho.id = b_application_id&lt;br/&gt;                        )&lt;br/&gt;     ;                   &lt;br/&gt;  begin&lt;br/&gt;    execute immediate c_dll;&lt;br/&gt;    wwv_flow_api.set_security_group_id(apex_util.find_security_group_id(p_workspace));&lt;br/&gt;    for r_mes in c_mes(p_application_id)&lt;br/&gt;    loop&lt;br/&gt;      wwv_flow_api.create_shortcut (&lt;br/&gt;        p_flow_id=&gt; p_application_id,&lt;br/&gt;        p_shortcut_name=&gt; r_mes.name,&lt;br/&gt;        p_shortcut_type=&gt; r_mes.shortcut_type&lt;br/&gt;      );&lt;br/&gt;    end loop;&lt;br/&gt;    commit;&lt;br/&gt;  end add_shortcuts;&lt;br/&gt;  &lt;br/&gt;  function add_messages (p_application_id    in number&lt;br/&gt;                        ,p_language          in varchar2&lt;br/&gt;                        ,p_include_custom    in varchar2 default &apos;Y&apos;&lt;br/&gt;                        ,p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;                        )&lt;br/&gt;  return varchar2&lt;br/&gt;  is&lt;br/&gt;    cursor c_mes(b_application_id    in number&lt;br/&gt;                ,b_language          in varchar2&lt;br/&gt;                ,b_include_custom    in varchar2&lt;br/&gt;                ,b_include_shortcut  in varchar2&lt;br/&gt;                )&lt;br/&gt;    is&lt;br/&gt;      select mes.text&lt;br/&gt;      ,      mes.name&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  not exists (select &apos;&apos;&lt;br/&gt;                         from   apex_application_translations tra&lt;br/&gt;                         where  tra.application_id = b_application_id&lt;br/&gt;                         and    tra.translatable_message = mes.name&lt;br/&gt;                         and    tra.language_code = mes.language_code&lt;br/&gt;                        )&lt;br/&gt;      and    mes.language_code = b_language&lt;br/&gt;      and    (&lt;br/&gt;              mes.custom = b_include_custom&lt;br/&gt;              or&lt;br/&gt;              b_include_custom = &apos;Y&apos;&lt;br/&gt;             )&lt;br/&gt;      and    (&lt;br/&gt;              mes.shortcut = b_include_shortcut&lt;br/&gt;              or&lt;br/&gt;              b_include_shortcut = &apos;Y&apos;&lt;br/&gt;             )       &lt;br/&gt;    ;&lt;br/&gt;    i number :=0;&lt;br/&gt;    v_melding varchar2(32767);&lt;br/&gt;  begin&lt;br/&gt;    apex_debug.message(&apos;Start add_messages&apos;);&lt;br/&gt;    apex_debug.message(&apos;Parameters  1 &apos;||p_application_id||&apos;, 2 &apos;||p_language||&apos;, 3 &apos;||p_include_custom||&apos;, 4 &apos;||p_include_shortcut);&lt;br/&gt;    for r_mes in c_mes(p_application_id,p_language,p_include_custom, p_include_shortcut)&lt;br/&gt;    loop&lt;br/&gt;      i := i+1;&lt;br/&gt;      wwv_flow_api.create_message (&lt;br/&gt;        p_flow_id =&gt; p_application_id,&lt;br/&gt;        p_name =&gt; r_mes.name,&lt;br/&gt;        p_message_language =&gt; p_language,&lt;br/&gt;        p_message_text =&gt; r_mes.text&lt;br/&gt;      );&lt;br/&gt;    end loop;&lt;br/&gt;    v_melding := case i&lt;br/&gt;                   when 0 &lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;NO_INSERT&apos;,&apos;messages&apos;)&lt;br/&gt;                   when 1&lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;1_INSERT&apos;,&apos;message&apos;)&lt;br/&gt;                 else&lt;br/&gt;                   apex_lang.message(&apos;MULTIPLE_INSERT&apos;,&apos;messages&apos;,i)&lt;br/&gt;                 end;             &lt;br/&gt;    apex_debug.message(&apos;End add_messages&apos;);             &lt;br/&gt;    return v_melding;&lt;br/&gt;  end add_messages;&lt;br/&gt;  &lt;br/&gt;  function add_shortcuts(p_application_id in number)&lt;br/&gt;  return varchar2&lt;br/&gt;  is&lt;br/&gt;    cursor c_mes(b_application_id in number)&lt;br/&gt;    is&lt;br/&gt;      select mes.name&lt;br/&gt;      ,      decode(mes.javascript,&apos;Y&apos;,&apos;MESSAGE_ESCAPE_JS&apos;,&apos;MESSAGE&apos;) shortcut_type&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  mes.shortcut = &apos;Y&apos;&lt;br/&gt;      and    not exists (select &apos;&apos;&lt;br/&gt;                         from   apex_application_shortcuts sho&lt;br/&gt;                         where  sho.shortcut_name = mes.name&lt;br/&gt;                         and    sho.application_id = b_application_id&lt;br/&gt;                        )&lt;br/&gt;    ;&lt;br/&gt;    i           number := 0;&lt;br/&gt;    v_melding   varchar2(32767);&lt;br/&gt;  begin&lt;br/&gt;    for r_mes in c_mes(p_application_id)&lt;br/&gt;    loop&lt;br/&gt;      i := i + 1;&lt;br/&gt;      wwv_flow_api.create_shortcut (&lt;br/&gt;        p_flow_id=&gt; p_application_id,&lt;br/&gt;        p_shortcut_name=&gt; r_mes.name,&lt;br/&gt;        p_shortcut_type=&gt; r_mes.shortcut_type&lt;br/&gt;      );&lt;br/&gt;    end loop;&lt;br/&gt;    v_melding := case i&lt;br/&gt;                   when 0 &lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;NO_INSERT&apos;,&apos;shortcuts&apos;)&lt;br/&gt;                   when 1&lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;1_INSERT&apos;,&apos;shortcut&apos;)&lt;br/&gt;                 else&lt;br/&gt;                   apex_lang.message(&apos;MULTIPLE_INSERT&apos;,&apos;shortcuts&apos;,i)&lt;br/&gt;                 end; &lt;br/&gt;    return v_melding;&lt;br/&gt;  end add_shortcuts;&lt;br/&gt;  &lt;br/&gt;  function update_messages (&lt;br/&gt;    p_application_id    in number,&lt;br/&gt;    p_language          in varchar2,&lt;br/&gt;    p_include_custom    in varchar2 default &apos;Y&apos;,&lt;br/&gt;    p_include_shortcut  in varchar2 default &apos;Y&apos;&lt;br/&gt;  )&lt;br/&gt;  return varchar2&lt;br/&gt;  is&lt;br/&gt;    cursor c_mes (&lt;br/&gt;      b_application_id in number,&lt;br/&gt;      b_language       in varchar2,&lt;br/&gt;      b_include_custom in varchar2,&lt;br/&gt;      b_include_shortcut in varchar2&lt;br/&gt;    ) is&lt;br/&gt;      select mes.text&lt;br/&gt;      ,      mes.name&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  exists (select &apos;&apos;&lt;br/&gt;                     from   apex_application_translations tra&lt;br/&gt;                     where  tra.application_id = b_application_id&lt;br/&gt;                     and    tra.translatable_message = mes.name&lt;br/&gt;                     and    tra.language_code = mes.language_code&lt;br/&gt;                     and    tra.message_text != mes.text&lt;br/&gt;                    )&lt;br/&gt;      and    mes.language_code = b_language&lt;br/&gt;      and    (&lt;br/&gt;              mes.custom = b_include_custom&lt;br/&gt;              or&lt;br/&gt;              b_include_custom = &apos;Y&apos;&lt;br/&gt;             )&lt;br/&gt;      and    (&lt;br/&gt;              mes.shortcut = b_include_shortcut&lt;br/&gt;              or&lt;br/&gt;              b_include_shortcut = &apos;Y&apos;&lt;br/&gt;             )       &lt;br/&gt;    ;&lt;br/&gt;    i number := 0;&lt;br/&gt;    v_melding varchar2(32767);&lt;br/&gt;  begin&lt;br/&gt;    for r_mes in c_mes(p_application_id,p_language,p_include_custom, p_include_shortcut)&lt;br/&gt;    loop&lt;br/&gt;      i := i+1;&lt;br/&gt;      update wwv_flow_messages$ mes&lt;br/&gt;      set    mes.message_text = r_mes.text&lt;br/&gt;      where  mes.name = r_mes.name&lt;br/&gt;      ;&lt;br/&gt;    end loop;&lt;br/&gt;    v_melding := case i&lt;br/&gt;                   when 0 &lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;NO_UPDATE&apos;,&apos;messages&apos;)&lt;br/&gt;                   when 1&lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;1_UPDATE&apos;,&apos;message&apos;)&lt;br/&gt;                 else&lt;br/&gt;                   apex_lang.message(&apos;MULTIPLE_UPDATE&apos;,&apos;messages&apos;,i)&lt;br/&gt;                 end; &lt;br/&gt;    return v_melding;&lt;br/&gt;  end update_messages;&lt;br/&gt;  &lt;br/&gt;  function update_shortcuts(p_application_id in number)&lt;br/&gt;  return varchar2&lt;br/&gt;  is&lt;br/&gt;    cursor c_mes(b_application_id in number)&lt;br/&gt;    is&lt;br/&gt;      select mes.name&lt;br/&gt;      ,      decode(mes.javascript,&apos;Y&apos;,&apos;MESSAGE_ESCAPE_JS&apos;,&apos;MESSAGE&apos;) shortcut_type&lt;br/&gt;      from   messages mes&lt;br/&gt;      where  mes.shortcut = &apos;Y&apos;&lt;br/&gt;      and    not exists (select &apos;&apos;&lt;br/&gt;                         from   apex_application_shortcuts sho&lt;br/&gt;                         where  sho.shortcut_name = mes.name&lt;br/&gt;                         and    sho.application_id = b_application_id&lt;br/&gt;                         and    sho.shortcut_type != decode(mes.javascript,&lt;br/&gt;                                                            &apos;Y&apos;,&apos;MESSAGE_ESCAPE_JS&apos;,&lt;br/&gt;                                                            &apos;MESSAGE&apos;&lt;br/&gt;                                                           )&lt;br/&gt;                        )&lt;br/&gt;    ;&lt;br/&gt;    i           number := 0;&lt;br/&gt;    v_melding   varchar2(32767);&lt;br/&gt;  begin&lt;br/&gt;    for r_mes in c_mes(p_application_id)&lt;br/&gt;    loop&lt;br/&gt;      i := i + 1;&lt;br/&gt;      update wwv_flow_shortcuts sho&lt;br/&gt;      set    sho.shortcut_type = r_mes.shortcut_type&lt;br/&gt;      where  sho.shortcut_name = r_mes.name&lt;br/&gt;      ;&lt;br/&gt;    end loop;&lt;br/&gt;    v_melding := case i&lt;br/&gt;                   when 0 &lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;NO_UPDATE&apos;,&apos;shortcuts&apos;)&lt;br/&gt;                   when 1&lt;br/&gt;                   then&lt;br/&gt;                     apex_lang.message(&apos;1_UPDATE&apos;,&apos;shortcut&apos;)&lt;br/&gt;                 else&lt;br/&gt;                   apex_lang.message(&apos;MULTIPLE_UPDATE&apos;,&apos;shortcuts&apos;,i)&lt;br/&gt;                 end; &lt;br/&gt;    return v_melding;&lt;br/&gt;  end update_shortcuts;&lt;br/&gt;  &lt;br/&gt;end do_translations;</source>
</body>
</PackageOracle>